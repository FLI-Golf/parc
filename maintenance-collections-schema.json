{
  "collections": [
    {
      "id": "maintenance_tasks_collection",
      "name": "maintenance_tasks",
      "type": "base",
      "system": false,
      "schema": [
        {
          "id": "task_name",
          "name": "task_name",
          "type": "text",
          "system": false,
          "required": true,
          "options": {
            "min": null,
            "max": 200,
            "pattern": ""
          }
        },
        {
          "id": "description",
          "name": "description",
          "type": "text",
          "system": false,
          "required": false,
          "options": {
            "min": null,
            "max": 1000,
            "pattern": ""
          }
        },
        {
          "id": "category",
          "name": "category",
          "type": "select",
          "system": false,
          "required": true,
          "options": {
            "maxSelect": 1,
            "values": [
              "kitchen",
              "equipment",
              "cleaning",
              "safety",
              "hvac",
              "plumbing",
              "electrical",
              "pest_control",
              "fire_safety",
              "general"
            ]
          }
        },
        {
          "id": "frequency",
          "name": "frequency",
          "type": "select",
          "system": false,
          "required": true,
          "options": {
            "maxSelect": 1,
            "values": [
              "daily",
              "weekly",
              "bi_weekly",
              "monthly",
              "quarterly",
              "bi_annually",
              "yearly",
              "as_needed"
            ]
          }
        },
        {
          "id": "priority",
          "name": "priority",
          "type": "select",
          "system": false,
          "required": true,
          "options": {
            "maxSelect": 1,
            "values": [
              "low",
              "medium",
              "high",
              "critical"
            ]
          }
        },
        {
          "id": "estimated_duration",
          "name": "estimated_duration",
          "type": "number",
          "system": false,
          "required": false,
          "options": {
            "min": 0,
            "max": null
          }
        },
        {
          "id": "required_supplies",
          "name": "required_supplies",
          "type": "text",
          "system": false,
          "required": false,
          "options": {
            "min": null,
            "max": 500,
            "pattern": ""
          }
        },
        {
          "id": "assigned_staff",
          "name": "assigned_staff",
          "type": "relation",
          "system": false,
          "required": false,
          "options": {
            "collectionId": "staff_collection",
            "cascadeDelete": false,
            "minSelect": null,
            "maxSelect": 1,
            "displayFields": [
              "first_name",
              "last_name"
            ]
          }
        },
        {
          "id": "vendor_required",
          "name": "vendor_required",
          "type": "bool",
          "system": false,
          "required": false
        },
        {
          "id": "vendor",
          "name": "vendor",
          "type": "relation",
          "system": false,
          "required": false,
          "options": {
            "collectionId": "vendors_collection",
            "cascadeDelete": false,
            "minSelect": null,
            "maxSelect": 1,
            "displayFields": [
              "name"
            ]
          }
        },
        {
          "id": "status",
          "name": "status",
          "type": "select",
          "system": false,
          "required": true,
          "options": {
            "maxSelect": 1,
            "values": [
              "active",
              "inactive",
              "suspended"
            ]
          }
        }
      ],
      "indexes": [],
      "listRule": "",
      "viewRule": "",
      "createRule": "@request.auth.role = 'manager' || @request.auth.role = 'owner'",
      "updateRule": "@request.auth.role = 'manager' || @request.auth.role = 'owner'",
      "deleteRule": "@request.auth.role = 'owner'",
      "options": {}
    },
    {
      "id": "maintenance_schedules_collection",
      "name": "maintenance_schedules",
      "type": "base",
      "system": false,
      "schema": [
        {
          "id": "task",
          "name": "task",
          "type": "relation",
          "system": false,
          "required": true,
          "options": {
            "collectionId": "maintenance_tasks_collection",
            "cascadeDelete": true,
            "minSelect": null,
            "maxSelect": 1,
            "displayFields": [
              "task_name"
            ]
          }
        },
        {
          "id": "scheduled_date",
          "name": "scheduled_date",
          "type": "date",
          "system": false,
          "required": true,
          "options": {
            "min": "",
            "max": ""
          }
        },
        {
          "id": "scheduled_time",
          "name": "scheduled_time",
          "type": "text",
          "system": false,
          "required": false,
          "options": {
            "min": null,
            "max": 5,
            "pattern": "^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$"
          }
        },
        {
          "id": "status",
          "name": "status",
          "type": "select",
          "system": false,
          "required": true,
          "options": {
            "maxSelect": 1,
            "values": [
              "pending",
              "in_progress",
              "completed",
              "overdue",
              "cancelled",
              "rescheduled"
            ]
          }
        },
        {
          "id": "assigned_to",
          "name": "assigned_to",
          "type": "relation",
          "system": false,
          "required": false,
          "options": {
            "collectionId": "staff_collection",
            "cascadeDelete": false,
            "minSelect": null,
            "maxSelect": 1,
            "displayFields": [
              "first_name",
              "last_name"
            ]
          }
        },
        {
          "id": "notes",
          "name": "notes",
          "type": "text",
          "system": false,
          "required": false,
          "options": {
            "min": null,
            "max": 1000,
            "pattern": ""
          }
        },
        {
          "id": "completion_date",
          "name": "completion_date",
          "type": "date",
          "system": false,
          "required": false,
          "options": {
            "min": "",
            "max": ""
          }
        },
        {
          "id": "next_due_date",
          "name": "next_due_date",
          "type": "date",
          "system": false,
          "required": false,
          "options": {
            "min": "",
            "max": ""
          }
        }
      ],
      "indexes": [],
      "listRule": "",
      "viewRule": "",
      "createRule": "@request.auth.role = 'manager' || @request.auth.role = 'owner'",
      "updateRule": "@request.auth.role = 'manager' || @request.auth.role = 'owner' || (@request.auth.id = assigned_to.user_id && status = 'pending')",
      "deleteRule": "@request.auth.role = 'owner'",
      "options": {}
    },
    {
      "id": "maintenance_records_collection",
      "name": "maintenance_records",
      "type": "base",
      "system": false,
      "schema": [
        {
          "id": "schedule",
          "name": "schedule",
          "type": "relation",
          "system": false,
          "required": true,
          "options": {
            "collectionId": "maintenance_schedules_collection",
            "cascadeDelete": true,
            "minSelect": null,
            "maxSelect": 1,
            "displayFields": []
          }
        },
        {
          "id": "completed_by",
          "name": "completed_by",
          "type": "relation",
          "system": false,
          "required": true,
          "options": {
            "collectionId": "staff_collection",
            "cascadeDelete": false,
            "minSelect": null,
            "maxSelect": 1,
            "displayFields": [
              "first_name",
              "last_name"
            ]
          }
        },
        {
          "id": "actual_duration",
          "name": "actual_duration",
          "type": "number",
          "system": false,
          "required": false,
          "options": {
            "min": 0,
            "max": null
          }
        },
        {
          "id": "supplies_used",
          "name": "supplies_used",
          "type": "text",
          "system": false,
          "required": false,
          "options": {
            "min": null,
            "max": 500,
            "pattern": ""
          }
        },
        {
          "id": "completion_notes",
          "name": "completion_notes",
          "type": "text",
          "system": false,
          "required": false,
          "options": {
            "min": null,
            "max": 1000,
            "pattern": ""
          }
        },
        {
          "id": "issues_found",
          "name": "issues_found",
          "type": "text",
          "system": false,
          "required": false,
          "options": {
            "min": null,
            "max": 1000,
            "pattern": ""
          }
        },
        {
          "id": "photos",
          "name": "photos",
          "type": "file",
          "system": false,
          "required": false,
          "options": {
            "maxSelect": 5,
            "maxSize": 5242880,
            "mimeTypes": [
              "image/jpeg",
              "image/png",
              "image/webp"
            ],
            "thumbs": [
              "100x100"
            ]
          }
        },
        {
          "id": "cost",
          "name": "cost",
          "type": "number",
          "system": false,
          "required": false,
          "options": {
            "min": 0,
            "max": null
          }
        }
      ],
      "indexes": [],
      "listRule": "",
      "viewRule": "",
      "createRule": "@request.auth.role = 'manager' || @request.auth.role = 'owner' || @request.auth.id = completed_by.user_id",
      "updateRule": "@request.auth.role = 'manager' || @request.auth.role = 'owner'",
      "deleteRule": "@request.auth.role = 'owner'",
      "options": {}
    }
  ]
}
